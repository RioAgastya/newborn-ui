<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Payment</title>

    <!-- CSS -->
    <link rel="stylesheet" href="./payment.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap"
    />
    <link rel="stylesheet" href="./asset/index.css" />
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link rel="stylesheet" href="./asset/global.css" />
    <link rel="stylesheet" href="./asset/payment-gateway.css" />
    <link rel="stylesheet" href="./asset/payment.css">
    <style>
      button {
        cursor: pointer;
      }

      .d-none {
        display: none;
      }
    </style>
  </head>
  <body>
    <section class="payment" id="firststep">
      <div class="overlap-group-wrapper">
        <div class="overlap-group">
          <div class="graphic">
            <img class="vector" src="./public/vector-14@2x.png" />
            <img class="img" src="./public/vector-9@2x.png" />
            <img class="vector-2" src="public/vector-8@2x.png" />
            <img class="daisy" src="./public/daisy-1@2x.png" />
          </div>
          <div class="content">
            <div class="doctor">
              <div class="foto">
                <img src="./public/avatar@2x.png" alt="" />
              </div>
              <div class="nama">
                <div class="text-wrapper">Dr. Evilia Rachmat</div>
                <div class="div">Spesialis Anak</div>
              </div>
            </div>
            <div class="total-tagihan">
              <div class="div-2">
                <p class="text-wrapper-2">Biaya per sesi</p>
                <div class="text-wrapper-3">Rp. 50.000</div>
              </div>
              <div class="div-2">
                <div class="text-wrapper-2">Biaya Layanan</div>
                <div class="text-wrapper-3">Rp. 5.500</div>
              </div>
              <div class="total">
                <div class="text-wrapper-2"><b>Total Tagihan</b></div>
                <div class="text-wrapper-3" id="texttotal">
                  <b>Rp. 55.500</b>
                </div>
              </div>
            </div>
            <div class="doctor-2">
              <div class="text-wrapper-4">Keluhan</div>
              <p class="p" id="textkeluhan">
                Anak saya sudah 2 Minggu sakit tenggorokan dan mengeluh susah
                menelan.
              </p>
            </div>
          </div>
          <button type="button" id="nextbtn" class="button">
            <div class="text-wrapper-5">Lanjut</div>
          </button>
        </div>
      </div>
    </section>
    <div class="container d-none" id="secondstep">
      <form id="paymentform">
        <div class="row">
          <div class="col">
            <h3 class="title">billing address</h3>

            <div class="inputBox">
              <span>full name :</span>
              <input
                type="text"
                placeholder="john deo"
                name="fullname"
                id="fullname"
              />
            </div>
            <div class="inputBox">
              <span>email :</span>
              <input
                type="email"
                placeholder="example@example.com"
                name="email"
                id="email"
              />
            </div>
            <div class="inputBox">
              <span>address :</span>
              <input
                type="text"
                placeholder="room - street - locality"
                name="address"
                id="address"
              />
            </div>
            <div class="inputBox">
              <span>city :</span>
              <input type="text" placeholder="mumbai" name="city" id="city" />
            </div>

            <div class="flex">
              <div class="inputBox">
                <span>state :</span>
                <input
                  type="text"
                  placeholder="india"
                  name="state"
                  id="state"
                />
              </div>
              <div class="inputBox">
                <span>zip code :</span>
                <input
                  type="text"
                  placeholder="123 456"
                  name="zipcode"
                  id="zipcode"
                />
              </div>
            </div>
          </div>

          <div class="col">
            <h3 class="title">payment</h3>

            <div class="inputBox">
              <span>cards accepted :</span>
              <img src="./public/card_img.png" alt="" />
            </div>
            <div class="inputBox">
              <span>name on card :</span>
              <input
                type="text"
                placeholder="mr. john deo"
                name="nameoncard"
                id="nameoncard"
              />
            </div>
            <div class="inputBox">
              <span>credit card number :</span>
              <input
                type="number"
                placeholder="1111-2222-3333-4444"
                name="credcardnum"
                id="credcardnum"
              />
            </div>
            <div class="inputBox">
              <span>exp month :</span>
              <input
                type="text"
                placeholder="january"
                name="expmonth"
                id="expmonth"
              />
            </div>

            <div class="flex">
              <div class="inputBox">
                <span>exp year :</span>
                <input
                  type="number"
                  placeholder="2022"
                  name="expyear"
                  id="expyear"
                />
              </div>
              <div class="inputBox">
                <span>CVV :</span>
                <input type="text" placeholder="1234" name="ccv" id="ccv" />
              </div>
            </div>
          </div>
        </div>

        <input
          type="submit"
          id="submitbtn"
          value="proceed to checkout"
          class="submit-btn"
        />
      </form>
    </div>
    <script>
      const form = document.querySelector('#paymentform');
      let stepcount = 1;

      const nextbtn = document.querySelector('#nextbtn');
      const submitbtn = document.querySelector('button[type="submit"]');
      const firstStepElem = document.querySelector('#firststep');
      const secondStepElem = document.querySelector('#secondstep');

      const paymentinfo = {
        price: 55_000,
        illness:
          'Anak saya sudah 2 Minggu sakit tenggorokan dan mengeluh susah menelan.',
        dochandler: 'Dr. Evilia Rachmat',
        fullname: '',
        email: '',
        address: '',
        city: '',
        state: '',
        zipcode: '',
        nameoncard: '',
        credcardnum: '',
        expmonth: '',
        expyear: '',
        ccv: '',
      };

      nextbtn.addEventListener('click', (e) => {
        firstStepElem.classList.add('d-none');
        nextbtn.classList.add('d-none');
        secondStepElem.classList.remove('d-none');
      });

      form.addEventListener('submit', async function (e) {
        e.preventDefault();
        paymentinfo.fullname = this.fullname.value.trim();
        paymentinfo.email = this.email.value.trim();
        paymentinfo.address = this.address.value.trim();
        paymentinfo.city = this.city.value.trim();
        paymentinfo.state = this.state.value.trim();
        paymentinfo.zipcode = this.zipcode.value.trim();
        paymentinfo.nameoncard = this.nameoncard.value.trim();
        paymentinfo.credcardnum = this.credcardnum.value.trim();
        paymentinfo.expmonth = this.expmonth.value.trim();
        paymentinfo.expyear = this.expyear.value.trim();
        paymentinfo.ccv = this.ccv.value.trim();

        const response = await fetch('payment.php', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(paymentinfo),
        });

        const result = await response.json();

        if (result.success) {
          alert(result.message);
          location.href = 'index.html';
        } else {
          alert(result.message);
        }
      });
    </script>
  </body>
</html>
